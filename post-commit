#!/bin/sh

CONFIG="$HOME/.git-commit-audio/config.sh"

if [ ! -f "$CONFIG" ]; then
  echo "\n$GCA: configuration not found, please re-install.\n"
  exit 1
fi

source $CONFIG

if [ ! -f "$GIT_COMMIT_AUDIO" ]; then
  echo "Git Commit Audio: audio not found '$GIT_COMMIT_AUDIO'"
  exit 1
fi

OS="$(uname)"
case "$OS" in
  Darwin)
    afplay "$GIT_COMMIT_AUDIO" &
    ;;
  Linux)
    if command -v aplay >/dev/null 2>&1; then
      aplay "$GIT_COMMIT_AUDIO" &
    elif command -v paplay >/dev/null 2>&1; then
      paplay "$GIT_COMMIT_AUDIO" &
    else
      echo "Git Commit Audio: audio player not found."
      exit 1
    fi
    ;;
  *)
    echo "Git Commit Audio: unsupported OS $OS"
    exit 1
esac
