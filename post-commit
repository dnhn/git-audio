#!/bin/sh

GCA="\e[1mGit Audio\e[22m"
CONFIG="$HOME/.git-audio/config.sh"

if [ ! -f $CONFIG ]; then
  printf "$GCA: configuration not found, please re-install.\n\n"
  exit 1
fi

. $CONFIG

if [ ! -f $GIT_AUDIO ]; then
  printf "$GCA: audio not found $GIT_AUDIO\n\n"
  exit 1
fi

OS=$(uname)
case $OS in
  Darwin)
    afplay $GIT_AUDIO &
    ;;
  Linux)
    if command -v paplay >/dev/null 2>&1; then
      paplay $GIT_AUDIO &
    elif command -v ffplay >/dev/null 2>&1; then
      ffplay -nodisp -autoexit -loglevel quiet $GIT_AUDIO &
    elif command -v aplay >/dev/null 2>&1; then
      aplay -q $GIT_AUDIO &
    else
      printf "$GCA: no supported audio player found.\n\n"
    fi
    ;;
  *)
    printf "$GCA: unsupported operating system $OS\n\n"
esac
